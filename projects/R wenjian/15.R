money<-c(256,502,519,354,641,542,547,535,650,326,
         248,419,606,531,549,541,250,599,646,469,
         557,406,237,251,353,476,292,407,569,252,
         695,568,448,216,618,591,301,532,435,293,
         340,497,447,653,445,627,362,279,394,377,
         508,352,388,337,572,275,208,214,232,268,
         471,514,564,400,697,333,270,686,651,229,
         343,222,699,218,559,617,505,612,683,466,
         598,386,424,597,561,457,349,479,638,585,
         405,624,682,489,245,607,660,551,380,487,
         242,586,676,235,372,220,546,420,441,363,
         673,300,240,304,367,529,636,512,678,593,
         543,576,254,664,590,410,449,398,507,433,
         299,294,255,403,691,303,594,382,274,528,
         633,409,390,269,396,399,228,443,553,670)
df<-data.frame(营销额=money)
df
par(mfrow=c(1,2),mai=c(0.6,0.7,0.4,0.1),cex.main=1,
    font.main=1)
hist(df$营销额,labels = FALSE,
     col="lightblue",xlab="营业额",ylab = "频数",
     main = "默认分组")

hist(df$营销额,breaks = 20,prob = TRUE,
     col="lightblue",xlab="营业额",ylab = "密度",
     main = "分成20组,添加核密度曲线")
lines(density(df$营销额),col=2,lwd=2)

jj<-c(91,82,66,96,89,69,83,99,90,55,51,59,95,98,62,
      97,87,86,65,78,50,77,73,84,61,94,68,92,75,93)
f<-c(91,82,66,96,89,69,83,99,90,55,51,59,95,98,62,
     97,87,86,65,78,50,77,73,84,61,94,68,92,75,93)
s<-c(91,82,66,96,89,69,83,99,90,55,51,59,95,98,62,
     97,87,86,65,78,50,77,73,84,61,94,68,92,75,93)
l<-c(91,82,66,96,89,69,83,99,90,55,51,59,95,98,62,
     97,87,86,65,78,50,77,73,84,61,94,68,92,75,93)
tj<-c(91,82,66,96,89,69,83,99,90,55,51,59,95,98,62,
      97,87,86,65,78,50,77,73,84,61,94,68,92,75,93)
tab<-data.frame(经济学院=jj,法学院=f,商学院=s,理学院=l,统计学院=tj)
tab
par(mai=c(0.7,0.7,0.1,0.1),cex =0.8)
library("RColorBrewer")
palette<-brewer.pal(5,"Set2")
boxplot(tab,xlab="学院",notch = FALSE,col = palette,ylab="英语分数")
points((apply(tab,2,mean)),col="blue3",lwd=1,cex=1.5,pch="+")
city<-c("北京","天津市","上海市","重庆市","河北省","山西省","辽宁省",
        "吉林省","黑龙江省","江苏省","浙江省","安徽省","福建省","江西省",
        "山东省","河南省","湖北省","湖南省","广东省","海南省","四川省",
        "贵州省","云南省","陕西省","甘肃省","青海省","台湾省","内蒙古自治区",
        "广西壮族自治区","西藏自治区","宁夏回族自治区")

r<-c(170846,126343,82180,190927,132224,95374,123528,199900,61076,124888,
     104786,133747,119263,62129,79942,72777,55039,88531,197152,68503,169551,
     57069,51388,164156,132516,184244,56173,167264,127554,90317,193052)

s<-c(7895.4,13638.7,2049.5,5740.3,19219.2,14713.6,13768.1,2377.8,15262.8,
     4323.7,9717.8,16775.1,17474.8,16085.0,4342.9,11147.9,2496.4,8869.4,19017.7,
     12473.6,3055.0,2021.5,7363.1,10014.5,14034.4,2700.3,9327.2,10996.6,10873.5,17756.3,8230.1)

d<-c(19151.24,6212.22,17248.43,3637.75,6669.32,12276.48,18147.59,2828.81,
     16349.19,19808.53,15367.05,11479.37,18380.91,3207.89,4532.19,13647.43,
     18000.04,8869.22,16851.73,13283.78,12636.36,7288.94,9652.90,4021.50,17012.90,
     13367.96,16847.11,19762.60,17479.71,13212.50,16755.29)

tab<-data.frame(地区=city,人均地区生产总值=r,
                社会消费品零售总额=s,地区财政一般预算支出=d)
#散点图
attach(tab)
par(mfrow=c(1,2),mai=c(0.7,0.7,0.3,0.1),cex = 0.7,cex.main=1,font.main=1)
plot(人均地区生产总值,社会消费品零售总额,pch=19,col="steelblue",
     xlab="人均地区生产总值",ylab="社会消费品零售总额",
     main="(a)人均地区生产总值与社会消费品零售总额的散点图")
#添加回归直线
abline(lm(社会消费品零售总额~人均地区生产总值),lwd=2,col="red")

plot(社会消费品零售总额,地区财政一般预算支出,pch=19,col="steelblue",
     xlab="社会消费品零售总额",ylab="地区财政一般预算支出",
     main="(b)社会消费品零售总额与地区财政一般预算支出散点图")
#添加回归直线
abline(lm(地区财政一般预算支出~社会消费品零售总额),lwd=2,col="red")

#气泡图
attach(tab)
symbols(x=人均地区生产总值,y=社会消费品零售总额,
        circles = 地区财政一般预算支出,
        inches = 0.2,fg="black",bg="pink")
mtext("气泡大小=地区财政一般预算支出",line = -19,cex = 0.7,adj = 0.9)


